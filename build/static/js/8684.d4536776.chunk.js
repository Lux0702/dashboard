"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8684],{75198:(e,s,t)=>{t.r(s),t.d(s,{default:()=>h});var n=t(72791),r=t(78983),o=t(24846),i=t(66064),c=t(9085),l=(t(5462),t(14701)),a=t(23458),d=t(80184);const h=()=>{const[e,s]=(0,n.useState)([]),[t,h]=(0,n.useState)(null),[x,u]=(0,n.useState)(null),[j,p]=(0,n.useState)(!1),[m,g]=(0,n.useState)(!1),[b,f]=(0,n.useState)([{status:"Pending",color:"gray"},{status:"Rejected",color:"red"},{status:"Approved",color:"green"}]);(0,n.useEffect)((()=>{j||h(null)}),[j]);const N=s=>{u(e.find((e=>e.id===s))),p(!0)},v=async()=>{const e=localStorage.getItem("userInfo"),t=JSON.parse(e).data.accessToken;try{g(!0);const e=await fetch("".concat(a.C,"/admin/dashboard/posts"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){const t=[...(await e.json()).data].sort(((e,s)=>new Date(s.orderDate)-new Date(e.orderDate)));s(t)}else console.error("Error fetching orders:",e.statusText)}catch(n){console.error("Error fetching orders:",n)}finally{g(!1)}};(0,n.useEffect)((()=>{v()}),[]);const y=e=>new Date(e).toLocaleDateString("en-CA"),w=async(e,s)=>{const t=localStorage.getItem("userInfo"),n=JSON.parse(t).data.accessToken;console.log(e,"v\xe0",s);try{g(!0);const t=await fetch("".concat(a.C,"/admin/dashboard/posts/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({status:s})});if(t.ok){console.log("Order ".concat(e," status updated to ").concat(s));const n=await t.json();c.Am.success(n.message),v()}else{console.error("Error updating order status:",t.statusText);const e=await t.json();c.Am.error(e.message)}}catch(r){c.Am.error("Error updating order status:",r)}finally{g(!1)}};return(0,d.jsxs)(r.rb,{children:[(0,d.jsx)(r.b7,{xs:12,children:(0,d.jsxs)(r.xH,{className:"mb-4",children:[(0,d.jsx)(r.bn,{children:(0,d.jsx)("strong",{children:"Danh s\xe1ch b\xe0i vi\u1ebft"})}),(0,d.jsxs)(r.sl,{children:[(0,d.jsxs)(r.Sx,{children:[(0,d.jsx)(r.V,{children:(0,d.jsxs)(r.T6,{children:[(0,d.jsx)(r.is,{scope:"col",children:"*"}),(0,d.jsx)(r.is,{scope:"col",children:"#"}),(0,d.jsx)(r.is,{scope:"col",children:"T\xean ng\u01b0\u1eddi \u0111\u0103ng"}),(0,d.jsx)(r.is,{scope:"col",children:"Ti\xeau \u0111\u1ec1"}),(0,d.jsx)(r.is,{scope:"col",children:"N\u1ed9i dung"}),(0,d.jsx)(r.is,{scope:"col",children:"Ng\xe0y \u0111\u0103ng"}),(0,d.jsx)(r.is,{scope:"col",children:"Tr\u1ea1ng th\xe1i"})]})}),(0,d.jsx)(r.NR,{children:e.map(((n,c)=>{var l;return(0,d.jsxs)(r.T6,{children:[(0,d.jsx)(r.NN,{children:(0,d.jsx)(o.Z,{icon:i.A,size:"xl",onClick:()=>{return e=n.id,h(e),console.log(e),void setTimeout((()=>N(e)),0);var e}})}),(0,d.jsx)(r.is,{scope:"row",children:c+1}),(0,d.jsx)(r.NN,{children:n.postedBy?n.postedBy.fullname:""}),(0,d.jsx)(r.NN,{children:n.title}),(0,d.jsx)(r.NN,{style:{width:"600px",height:"50px",overflowY:"hidden"},children:(0,d.jsx)("div",{style:{maxHeight:"50px",overflow:"hidden",textOverflow:"ellipsis"},children:n.content})}),(0,d.jsx)(r.NN,{children:y(n.postedDate)}),(0,d.jsx)(r.NN,{children:(0,d.jsxs)(r.w5,{variant:"btn-group",style:{borderRadius:"12px"},children:[(0,d.jsx)(r.SQ,{style:{backgroundColor:null===(l=b.find((e=>e.status===n.status)))||void 0===l?void 0:l.color,color:"white",border:"none",borderRadius:"20px"},children:n.status}),(0,d.jsx)(r.$H,{style:{borderRadius:"12px"},children:b.map(((o,i)=>(0,d.jsx)(r.$f,{style:{borderRadius:"12px"},onClick:()=>{h(n.id),console.log("id l\xe0: ",n.id),((n,r)=>{const o=e.map((e=>e.id===t?{...e,status:r}:e));s(o),w(n,r)})(n.id,o.status)},children:o.status},i)))})]})})]},c)}))})]}),(0,d.jsxs)(r.Tk,{size:"lg",alignment:"center",visible:j,onClose:()=>{p(!1)},children:[(0,d.jsx)(r.p0,{closeButton:!0,children:(0,d.jsx)(r.fl,{children:"Chi ti\u1ebft b\xe0i vi\u1ebft"})}),(0,d.jsx)(r.sD,{children:x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{children:["T\xean ng\u01b0\u1eddi \u0111\u0103ng:",(0,d.jsx)(r.jO,{"aria-label":"T\u1ef1a \u0111\u1ec1",disabled:!0,value:x.postedBy?x.postedBy.fullname:""})]}),(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsx)(r.rb,{children:(0,d.jsxs)(r.b7,{xs:"12",className:"mb-3",children:[(0,d.jsx)(r.L8,{htmlFor:"orderDate",children:"Ng\xe0y \u0111\u0103ng"}),(0,d.jsx)(r.jO,{disabled:!0,type:"date",id:"orderDate",name:"orderDate",value:y(x.postedDate)||0})]})})}),(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsx)(r.rb,{children:(0,d.jsxs)(r.b7,{xs:"12",className:"mb-3",children:[(0,d.jsx)(r.L8,{htmlFor:"status",children:"Tr\u1ea1ng th\xe1i:"}),(0,d.jsx)(r.jO,{disabled:!0,type:"text",id:"status",name:"status",value:x.status||""})]})})}),(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsx)(r.rb,{children:(0,d.jsxs)(r.b7,{xs:"12",className:"mb-3",children:[(0,d.jsx)(r.L8,{htmlFor:"content",children:"N\u1ed9i dung b\xe0i vi\u1ebft:"}),(0,d.jsx)(r.PB,{disabled:!0,rows:10,type:"text",id:"content",name:"content",value:x.content})]})})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{children:"B\xecnh lu\u1eadn:"}),(0,d.jsx)(r.uz,{flush:!0,children:x&&x.comments&&x.comments.map(((e,s)=>(0,d.jsxs)(r.Ob,{children:[(0,d.jsxs)(r.Lv,{children:[(0,d.jsx)("strong",{children:"T\xean Ng\u01b0\u1eddi b\xecnh lu\u1eadn: "})," ",e.user.fullname]}),(0,d.jsxs)(r.qI,{children:[(0,d.jsxs)("p",{children:["M\xe3 b\xecnh lu\u1eadn. ",e.id]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"N\u1ed9i dung:"})," ",e.comment]})]})]},s)))})]})]})})]})]})]})}),(0,d.jsx)(c.Ix,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),(0,d.jsx)(l.Z,{spinning:m,fullscreen:!0})]})}}}]);
//# sourceMappingURL=8684.d4536776.chunk.js.map